<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CyberBridge - SyncFlow Solutions</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<div class="dashboard-container container-fluid py-4">

  <!-- Header: SyncFlow branding -->
  <div class="header mb-4">
    <div class="logo">üõ°Ô∏è CyberBridge</div>
    <div class="tagline">Enterprise Security Awareness Platform</div>
    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e0e0e0; text-align: left;">
      <p style="margin: 3px 0; font-size: 14px;"><strong>Organization:</strong> <span id="org-name">Loading...</span></p>
      <p style="margin: 3px 0; font-size: 14px;"><strong>Role:</strong> <span id="user-role">Loading...</span></p>
      <p style="margin: 3px 0; font-size: 14px;"><strong>Industry:</strong> Professional Services | <strong>Employees:</strong> 75</p>
    </div>
  </div>

  <!-- KPI Cards -->
  <div class="row mb-4">
    <div class="col-md-3 mb-3">
      <div class="kpi-card">
        <div class="kpi-value" id="completion-percentage">--</div>
        <div class="kpi-label">Training Complete</div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="kpi-card">
        <div class="kpi-value" id="avg-score">--</div>
        <div class="kpi-label">Avg Quiz Score</div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="kpi-card">
        <div class="kpi-value" id="modules-completed">--</div>
        <div class="kpi-label">Modules Completed</div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="kpi-card">
        <div class="kpi-value" id="risk-score">--</div>
        <div class="kpi-label">Risk Score</div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row mb-4">
    <div class="col-md-6 mb-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Training Progress Over Time</h5>
          <canvas id="progressChart"></canvas>
        </div>
      </div>
    </div>
    <div class="col-md-6 mb-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Module Completion Status</h5>
          <canvas id="modulesChart"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Alerts & Modules Row -->
  <div class="row">
    <div class="col-md-6 mb-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">üö® Security Alerts</h5>
          <div id="alerts-section"></div>
        </div>
      </div>
    </div>
    <div class="col-md-6 mb-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">üìö Your Training Modules</h5>
          <div id="modules-list"></div>
          <button class="btn btn-primary btn-sm mt-3" onclick="startNewTraining()">
            Start New Module
          </button>
        </div>
      </div>
    </div>
  </div>

</div>

<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>

<script>
// Get user_id from URL parameter or localStorage
const urlParams = new URLSearchParams(window.location.search);
let userIdParam = urlParams.get('user_id');
if (userIdParam) {
  localStorage.setItem('user_id', userIdParam);
}
let USER_ID = localStorage.getItem('user_id') || 1;
</script>

</body>
</html>
